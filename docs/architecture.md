总体架构 (Architecture)

本节概述项目的整体架构设计，说明各模块组件如何协同工作，实现 HEA-DRL 算法。系统采用模块化、可插拔的设计，以便灵活更换策略和扩展功能。

系统组件

混合进化算法核心 (HEA Core)：算法主体，结合遗传算法的全局搜索与局部搜索策略进行求解。负责种群初始化、进化迭代，以及调用移除/修复算子进行解优化。

移除策略模块 (Removal Strategy)：局部搜索中的“破坏”算子，按策略从解中移除若干任务。实现了多种策略（随机、Shaw、DRL），通过统一接口与核心算法解耦。

修复策略模块 (Repair Strategy)：局部搜索中的“重建”算子，将被移除的任务重新插入解中。采用既定的启发式算法（如贪心插入或后悔插入）确保生成可行解。

深度强化学习代理 (DRL Agent)：使用DRL学习智能移除策略的模块。在策略为“DRL移除”时由HEA核心调用，输出应移除的任务集合。该模块可独立训练，并通过模型文件与核心算法接口相连。

数据生成与管理：负责提供问题实例数据，包括随机生成模拟数据或读取预先配置的数据集。确保算法获取初始解和评估函数所需的信息。

日志与计时：在算法运行过程中记录关键指标和时间，用于分析算法性能（例如各阶段耗时、解质量变化）。日志记录模块与核心算法集成，但可配置启用/禁用或详细程度。

以上模块各司其职，通过清晰的接口进行通信。核心算法（HEA）相当于调度中心，在不同阶段调用相应模块完成任务。

算法流程概述

HEA-DRL 算法的大致流程如下：

初始化：生成初始解或初始种群。对于遗传算法，创建一定数量的随机可行解个体，并计算其适应度（目标函数值）。

遗传迭代：循环执行以下步骤直至终止条件满足（如达到最大代数或时间限制）：

选择 (Selection)：根据适应度选择部分个体作为父代（例如轮盘赌选择或锦标赛选择）。

交叉 (Crossover)：对选中的父代个体执行交叉操作，生成子代解，以组合父解的特征。(若采用其它进化策略，可调整此步，例如直接复制或使用变异算子等)。

变异 (Mutation)：对部分子代解施加轻微随机扰动（如交换解的部分顺序），增加解的多样性。(可选步骤，如果需要更丰富的解空间探索)。

局部搜索 (Removal & Repair)：对新生成的解进行局部优化。具体地，按照配置的移除策略，从解中删除若干任务；随后用修复策略将其重新插入，从而得到潜在更优的解。
link.springer.com
这一“破坏-重建”过程能利用启发式方法细化解，提高解质量。

种群更新：将得到的新解评估其适应度，并与当前种群合并或替换（根据选择策略保留最好个体或维持种群多样性）。这样进入下一代迭代。

终止与输出：当达到预设代数或其他终止条件时，算法停止。输出最优解及其目标值，同时记录运行时间、收敛曲线等信息用于分析。

在整个过程中，HEA核心通过调用不同模块函数实现各步骤。例如，使用移除策略模块的接口执行局部搜索破坏操作，调用修复模块完成重建操作，调用日志模块记录每代结果等。各模块之间通过参数和返回值交互，避免直接耦合。

模块交互与数据流

在 初始化 时，数据模块提供生成的初始任务集，HEA核心基于这些数据创建初始解。此阶段会调用评估函数计算解的目标值供选择用。

进入 进化循环 后，HEA核心按顺序驱动各模块：

调用遗传操作模块产生新解；

然后调用 移除策略接口 (根据当前配置的策略) 对每个新解执行局部扰动。对于随机或Shaw策略，直接在本地按相应逻辑选择任务移除；对于DRL策略，则通过DRL模块接口获得应移除任务列表。

随后调用 修复策略 将任务插回，生成完整的可行解。

由此得到优化后的子代解，并由 HEA 核心计算其适应度，决定是否进入下一代种群。

DRL 模块 在被调用时，需从核心获取当前解的特征表示。核心将当前解状态传递给 DRL 模块，后者返回一个决策（要移除的任务集合）。这一过程通过预定义接口完成，使核心无需了解DRL内部实现。对于非DRL策略，该模块接口可以为空实现或跳过。

日志模块 则在每代循环结束、以及算法终止时，由核心调用以记录必要的信息。核心会传递当前代数、最好解值、耗时等数据给日志记录功能，从而将其写入日志文件或控制台输出。

整个数据流通过上述调用顺序流转，各模块高度解耦。配置文件决定使用何种移除策略、参数取值等，从而动态影响上述流程中的决策路径。

可插拔接口设计

为了提高系统灵活性，本框架针对关键策略组件采用可插拔接口设计：

移除策略接口：使用统一的方法签名（例如 remove_tasks(solution, k)）定义。HEA 核心在局部搜索阶段调用该接口，而具体的实现由所选策略决定。通过在配置中切换策略名称，即可插拔地替换移除算子，而无需修改核心代码。

DRL 模块接口：DRL 算法作为移除策略的一种，通过接口与核心通讯。例如，核心调用 drl_agent.select_removal(solution, k) 来获取DRL策略选择的任务子集。如果禁用DRL，只需在配置中选择其他策略，DRL模块接口不会被触发，不影响整体流程。

参数配置接口：核心算法的各种参数（种群规模、迭代次数、移除数量等）均通过配置文件注入，而非硬编码在程序中。这种设计允许无需改动代码即可调整实验条件、扩展新的参数选项。

模块扩展：开发者可以基于已有接口添加新模块，例如新的移除策略、新的修复方法或不同的评估函数。只需遵循接口规范，在核心注册调用，即可无缝集成。这体现了框架的可扩展性设计，方便日后针对不同问题或新算法思想进行拓展。

通过以上设计，本系统具有良好的松耦合和可扩展特性。各功能模块既可协同工作，又可独立开发测试，满足本地实验开发需求。